/* ===========================
   PALETA + TIPOGRAFÍA BASE
   Fondo claro verde tenue — sin degradados
   =========================== */
:root{
  --mint:#CDEEDD;
  --lilac:#E4D8F2;
  --blue:#D5EAF6;
  --yellow:#FFF4CC;

  --paper:#F3FAF6;    /* fondo claro */
  --card:#FFFFFF;     /* tarjetas */
  --ink:#0E2A1F;
  --ink-2:#2C4F42;
  --line:rgba(15,42,32,.12);
  --muted:#567567;
  --ring:#79D3B1;

  --helpbg: color-mix(in oklab, var(--card) 96%, black 4%);
}
html[data-theme="dark"]{
  --paper:#0B1A14;
  --card:#10251C;
  --ink:#EAF5EF;
  --ink-2:#CFE7DD;
  --line:rgba(168,230,207,.22);
  --muted:#A8C9B9;
  --ring:#8FE3BF;
  --helpbg: color-mix(in oklab, var(--card) 88%, white 12%);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:"DM Sans",system-ui,-apple-system,Segoe UI,Roboto,Arial;
  color:var(--ink); background:var(--paper);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
#bg{position:fixed; inset:0; z-index:-1; opacity:.08} /* doodles sutiles */

/* Header y nav */
.site-header{ position:sticky; top:0; z-index:8; padding:14px 20px; border-bottom:1px solid var(--line); background:color-mix(in oklab, var(--paper) 92%, transparent 8%); backdrop-filter:blur(8px) }
.brand{text-decoration:none; color:inherit}
.brand-line{display:flex; align-items:flex-end; gap:10px; flex-wrap:wrap}
.brand-a{ font-family:"Outfit",sans-serif; font-weight:900; font-size:clamp(22px,5vw,40px); color:var(--ink) }
.brand-b{ font-weight:900; font-size:clamp(22px,5vw,40px); color:var(--ink-2) }
.brand-dot{ width:10px; height:10px; border-radius:50%; background:var(--mint); align-self:center; animation:blink 2.6s infinite ease-in-out }
@keyframes blink{ 50%{ transform:scale(.65) } }
.brand-sub{ font-size:.9rem; color:var(--muted); opacity:.9 }

/* Menú lateral */
.hamburger{ position:fixed; top:14px; right:16px; z-index:12; width:42px; height:42px; border:1px solid var(--line); background:var(--card); border-radius:12px; display:grid; place-items:center; cursor:pointer }
.hamburger span{ display:block; width:22px; height:2px; background:var(--ink); margin:3px 0 }
.sidenav{ position:fixed; top:0; right:-280px; width:260px; height:100%; background:var(--card); border-left:1px solid var(--line); z-index:11; transition:right .25s; padding:16px }
.sidenav.open{ right:0 }
.sidenav-close{ background:transparent; border:none; font-size:28px; color:var(--ink); cursor:pointer; margin-bottom:10px }
.snav-link{ display:block; padding:10px 12px; border:1px solid var(--line); border-radius:10px; color:inherit; text-decoration:none; margin:8px 0; background:var(--helpbg) }
.snav-link:hover{ outline:2px solid var(--ring) }

/* Dock */
.dock{ position:fixed; right:16px; bottom:16px; display:grid; gap:10px; z-index:10 }
.dock-btn{ width:42px; height:42px; border-radius:12px; border:1px solid var(--line); background:var(--card); color:var(--ink); cursor:pointer; display:grid; place-items:center; box-shadow:0 4px 10px rgba(0,0,0,.10); transition:transform .2s, box-shadow .2s }
.dock-btn:hover{ transform:scale(1.05); box-shadow:0 6px 14px rgba(0,0,0,.14) }
.dock-btn svg{ width:22px; height:22px }

/* Mascota Kiva */
.buddy{ position:fixed; left:16px; bottom:16px; z-index:10; width:74px; height:74px; border-radius:18px; border:1px solid var(--line); background:var(--card); display:grid; place-items:center; cursor:pointer; box-shadow:0 10px 24px rgba(0,0,0,.12) }
.cat{ width:58px; height:58px }
.cat.small{ width:42px; height:42px }
.c-face{ fill:#FFF; stroke:var(--line); stroke-width:1 }
.c-ear{ fill:none; stroke:#8ABFA5; stroke-width:3 }
.c-eye{ fill:#1b1b1b; animation:blinkEyes 5s infinite }
.c-nose{ fill:#E58B8B }
.c-mouth{ fill:none; stroke:#1b1b1b; stroke-width:3; stroke-linecap:round }
.c-tail{ fill:none; stroke:#86B89C; stroke-width:3; animation:tail 2.8s ease-in-out infinite }
.c-charm{ fill:#86B89C; opacity:.6 }
@keyframes tail{ 0%,100%{ d:path("M94 92 q18 10 -2 18")} 50%{ d:path("M94 92 q12 18 -6 16") } }
@keyframes blinkEyes{ 0%,92%,100%{transform:scaleY(1)} 95%{transform:scaleY(0.15)} }
.buddy-dialog{ border:none; padding:0; background:transparent }
.buddy-card{ width:min(600px, 92vw); background:var(--card); border:1px solid var(--line); border-radius:18px; padding:16px; box-shadow:0 14px 40px rgba(0,0,0,.14) }
.buddy-head{ display:flex; gap:12px; align-items:center; margin-bottom:8px }
.buddy-tabs{ display:flex; gap:8px; margin:6px 0 10px }
.bt{ padding:8px 10px; border-radius:10px; border:1px solid var(--line); background:var(--helpbg); cursor:pointer; font-weight:700 }
.bt.active{ outline:2px solid var(--ring) }
.buddy-body{ background:var(--helpbg); border:1px solid var(--line); border-radius:12px; padding:12px }
.pane.hidden{ display:none }
.buddy-list{ margin:0; padding-left:18px }
.buddy-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:10px }
.btn.ghost{ background:var(--card) }

/* Hero */
.hero{ padding:56px 20px 22px; text-align:center }
.title{ margin:0 0 8px }
.title-row{ display:block }
.t-1,.t-2,.t-3{ display:inline-block; margin:0 6px; transform-origin:70% 60%; transition:transform .08s }
.t-1{ color:#2E6B54 } .t-2{ color:#2E6B54 } .t-3{ color:#2E6B54 }
.t-alt .t-hand{ display:inline-block; margin-top:6px; font-family:"Outfit",sans-serif; font-weight:800; font-size:clamp(20px,4vw,30px); color:#2E6B54 }
.underline-wrap{ display:block; height:8px; overflow:hidden; margin:8px auto 0; width:min(560px, 90vw) }
.underline{ display:block; height:4px; background:#2E6B54; transform-origin:left; transform:scaleX(0); animation:grow 1.1s ease forwards }
@keyframes grow{ to{ transform:scaleX(1) } }
.subtle{ color:var(--muted) }

/* Cadena */
.chain{ margin:20px auto 0; width:min(560px,92vw); height:20px; display:flex; gap:8px; justify-content:center; align-items:center; user-select:none }
.chain .link{ width:80px; height:14px; border-radius:20px; background:var(--ink-2); opacity:.18; transition:.25s }
.chain.break .link{ transform:rotate(16deg) translateY(3px); opacity:.5; background:#2E6B54 }

/* Secciones */
.section{ padding:48px 20px; max-width:1180px; margin:0 auto }
.grid{ display:grid; gap:18px }
.grid.three{ grid-template-columns:repeat(auto-fit, minmax(260px, 1fr)) }
.grid.four{ grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)) }
.mt{ margin-top:18px }
.small{ font-size:.9rem }
.h-doodles{ font-family:"Outfit",sans-serif; font-weight:800; letter-spacing:.4px }

/* Aprende */
.learn-grid{ display:grid; gap:18px }
.learn-card{ border-radius:12px; overflow:hidden; border:1px solid var(--line); background:var(--card) }
.learn-top{ height:10px }
.learn-card.mint .learn-top{ background:var(--mint) }
.learn-card.purple .learn-top{ background:var(--lilac) }
.learn-card.pink .learn-top{ background:#F2C0C0 }
.learn-body{ display:flex; gap:14px; padding:16px }
.learn-doodle{ flex:0 0 56px; height:56px; border-radius:12px; border:1px solid var(--line); background:var(--blue); display:grid; place-items:center }
.learn-doodle svg{ width:28px; height:28px; color:#111 }
.learn-text h3{ margin:2px 0 8px }
.learn-text p{ margin:0 }

/* Flip cards (mitos) */
.flip{ perspective:1000px }
.flip__inner{ position:relative; width:100%; min-height:130px; transform-style:preserve-3d; transition:transform .6s; cursor:pointer }
.flip__front, .flip__back{
  position:absolute; inset:0; display:grid; place-items:center; padding:18px;
  border-radius:14px; background:var(--blue); border:1px dashed var(--line);
  backface-visibility:hidden; color:#111; font-weight:700
}
.flip__back{ transform:rotateY(180deg); background:var(--yellow) }
.flip:hover .flip__inner, .flip__inner:focus{ transform:rotateY(180deg) }

/* Explora bloques */
.game-block{ background:var(--card); border:1px solid var(--line); border-radius:16px; padding:18px; box-shadow:0 8px 18px rgba(0,0,0,.06); margin-bottom:18px; position:relative }

/* Emocionómetro (rostro mejorado) */
.emo-wrap{ display:grid; gap:10px; align-items:center; justify-items:center }
#emoRange{ width:min(560px, 90%); accent-color:#2E6B54 }
.emo-face{ width:100px; height:100px; border-radius:50%; background:#E6F4EC; position:relative; border:3px solid #2E6B54; transition:transform .25s ease, background .25s ease }
.eye{ position:absolute; top:34px; width:10px; height:10px; background:#111; border-radius:50%; animation:blinkEye 6s infinite }
.eye.l{ left:28px } .eye.r{ right:28px }
@keyframes blinkEye{ 0%,96%,100%{transform:scaleY(1)} 98%{transform:scaleY(.1)} }
.brow{ position:absolute; top:22px; width:18px; height:4px; background:#111; border-radius:4px; transform-origin:center }
.brow.l{ left:22px } .brow.r{ right:22px }
.mouth{ position:absolute; left:50%; bottom:22px; width:36px; height:18px; transform:translateX(-50%); border:3px solid #111; border-top:none; border-radius:0 0 20px 20px }
.tear{ position:absolute; right:34px; top:52px; width:8px; height:14px; background:#9EC8FF; border-radius:6px; opacity:0 }
.emo-face.pulse{ animation:pulse .9s ease-in-out infinite }
.emo-face.shake{ animation:shake .45s linear }
.emo-face.drop .tear{ animation:tearDrop 1s ease-in-out; opacity:1 }
@keyframes pulse{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.06)} }
@keyframes shake{ 0%,100%{transform:translateX(0)} 25%{transform:translateX(-4px)} 75%{transform:translateX(4px)} }
@keyframes tearDrop{ 0%{transform:translateY(0); opacity:0.9} 100%{transform:translateY(14px); opacity:0} }
.emo-label{ font-weight:800; color:var(--ink-2) }

/* Muros */
#muros .wall{ display:grid; gap:12px; grid-template-columns:repeat(6, 1fr) }
@media (max-width:1100px){ #muros .wall{ grid-template-columns:repeat(5, 1fr) } }
@media (max-width:820px){  #muros .wall{ grid-template-columns:repeat(4, 1fr) } }
@media (max-width:580px){  #muros .wall{ grid-template-columns:repeat(3, 1fr) } }
.brick{
  display:grid; place-items:center; text-align:center;
  min-height:56px; padding:10px 12px; border-radius:12px; border:1px solid var(--line);
  background:var(--helpbg); color:#111; font-weight:700; transition:transform .12s, filter .2s, opacity .2s, background-color .2s;
  cursor:pointer; position:relative; word-break:break-word;
}
.brick.hit::after{ content:""; position:absolute; inset:-4px; border-radius:14px; border:2px solid var(--blue); opacity:0; animation:hit .45s ease }
@keyframes hit{ 0%{opacity:.8; transform:scale(1)} 100%{opacity:0; transform:scale(1.1)} }
.brick.broken-anim{ transform-origin:bottom center; transform:scale(.9) rotate(3deg) translateY(10px); opacity:0; filter:blur(1px); transition:transform .3s ease-out, opacity .3s ease-out, filter .3s }
#muros .why{ margin-top:10px; font-weight:800; color:var(--ink) }

/* Botones reset icon-only */
.reset-btn{ position:absolute; top:16px; right:16px; font-size:0.9rem; padding:6px 8px; opacity:.6 }
.icon-only{ width:36px; height:36px; border-radius:10px; line-height:1; padding:0 }

/* Refugio seguro (escudo centrado y responsivo mejor) */
.refugio-wrap{ display:grid; grid-template-columns:minmax(260px, 340px) 1fr; gap:18px; align-items:start }
@media (max-width:900px){ .refugio-wrap{ grid-template-columns:1fr } }
.refugio-tray{
  display:flex; gap:8px; flex-wrap:wrap; align-content:flex-start;
  background:var(--helpbg); border:1px dashed var(--line);
  border-radius:12px; padding:10px; max-height:220px; overflow:auto;
}
.word{ border:1px solid var(--line); background:var(--lilac); border-radius:10px; padding:6px 10px; color:#111; cursor:grab; font-weight:700; touch-action:none }
.shield-area{
  position:relative; min-height:420px; border:1px dashed var(--line); border-radius:14px; background:var(--helpbg);
  display:grid; place-items:center; overflow:hidden;
}
.shield-bg{ width:min(82%, 520px); height:auto; color:#2E6B54 }
.slot{
  position:absolute; max-width:60%; min-width:96px; height:34px; padding:0 14px; border:1px solid var(--line); background:var(--blue);
  border-radius:10px; display:grid; place-items:center; color:#111; font-weight:800; white-space:nowrap; transform:translateX(-50%); box-shadow:0 1px 0 rgba(0,0,0,.06)
}
.slot[data-slot="1"]{ left:50%; top:20% }
.slot[data-slot="2"]{ left:50%; top:36% }
.slot[data-slot="3"]{ left:50%; top:52% }
.slot[data-slot="4"]{ left:50%; top:68% }
.slot[data-slot="5"]{ left:50%; top:84% }
.slot.pop{ animation:pop .3s ease-out }
@keyframes pop{ 0%{ transform:translateX(-50%) scale(1) } 50%{ transform:translateX(-50%) scale(1.08) } 100%{ transform:translateX(-50%) scale(1) } }
.refugio-msg{ margin-top:10px; font-weight:800 }

/* Memorama infantil (imágenes completas) */
.memory-grid{ display:grid; gap:12px; grid-template-columns:repeat(6, 1fr) }
@media (max-width:1100px){ .memory-grid{ grid-template-columns:repeat(5, 1fr) } }
@media (max-width:820px){  .memory-grid{ grid-template-columns:repeat(4, 1fr) } }
@media (max-width:580px){  .memory-grid{ grid-template-columns:repeat(3, 1fr) } }
.cardm{
  height:150px; border:1px solid var(--line); border-radius:12px; background:var(--card); position:relative; cursor:pointer; perspective:800px;
}
.cardm-inner{ position:absolute; inset:0; transform-style:preserve-3d; transition:transform .38s ease }
.cardm.revealed .cardm-inner{ transform:rotateY(180deg) }
.cardm-face{ position:absolute; inset:0; backface-visibility:hidden; border-radius:12px; overflow:hidden; display:grid; place-items:center }
.cardm-front{ background:var(--mint); border:1px solid var(--line); font-weight:900; color:#2E6B54; letter-spacing:.4px }
.cardm-back{ transform:rotateY(180deg); background:#FFFFFF; border:1px solid var(--line) }
.cardm-back img{ width:100%; height:100%; object-fit:contain; padding:10px } /* no recortes */
.cardm.shake{ animation:shake .4s cubic-bezier(.36,.07,.19,.97) }

/* Arma el mensaje */
.chips{ display:flex; gap:8px; flex-wrap:wrap; background:var(--helpbg); border:1px dashed var(--line); border-radius:12px; padding:10px }
.chip{ padding:8px 10px; border-radius:10px; border:1px solid var(--line); background:var(--blue); color:#111; cursor:grab; font-weight:800; touch-action:none }
.chip.dragging{ opacity:.5; transform:scale(.95); background:var(--lilac) }
.msg-out{ margin-top:10px; font-weight:800 }

/* Carrusel */
.carousel{ position:relative; border:1px solid var(--line); border-radius:16px; overflow:hidden; background:var(--card) }
.car-track{ display:flex; transition:transform .4s ease }
.slide{ width:100%; flex:0 0 100%; position:relative }
.slide img{ width:100%; height:auto; max-height:70vh; object-fit:contain; display:block; background:var(--card) }
.slide iframe{ width:100%; height:60vh; max-height:70vh; display:block }
.cap{ position:absolute; left:0; right:0; bottom:0; padding:8px 10px; background:rgba(0,0,0,.35); color:#fff; font-weight:800 }
.car-btn{ position:absolute; top:50%; transform:translateY(-50%); background:var(--helpbg); border:1px solid var(--line); color:var(--ink); width:36px; height:36px; border-radius:50%; cursor:pointer }
.car-btn.prev{ left:10px } .car-btn.next{ right:10px }

/* Foro (rediseño) */
.forum .alias{ border:1px solid var(--line); border-radius:10px; padding:8px 10px; background:var(--card); color:var(--ink) }
.forum textarea{ width:100%; border-radius:12px; border:1px solid var(--line); background:var(--card); color:var(--ink); padding:10px }
.forum-controls{ display:flex; gap:16px; flex-wrap:wrap; align-items:center; margin-bottom:10px }
.forum-actions{ margin:10px 0 }
.forum-list{ display:grid; gap:12px }
.post{ background:var(--card); border:1px solid var(--line); border-radius:12px; padding:12px; position:relative; overflow:hidden }
.post::before{ content:""; position:absolute; left:-18px; top:-18px; width:90px; height:90px; border:1px solid var(--line); transform:rotate(10deg); opacity:.08 }
.post .meta{ font-size:.8rem; color:var(--muted); margin-bottom:6px }
.post .actions{ display:flex; gap:8px; margin-top:6px }
.post button{ font-size:.8rem; padding:6px 8px; border-radius:8px; border:1px solid var(--line); background:var(--helpbg); cursor:pointer }
.post .badge{ position:absolute; right:8px; top:8px; font-size:.75rem; padding:4px 8px; border-radius:999px; border:1px solid var(--line); background:var(--mint); color:#111 }

/* Botón genérico */
.btn{ font-family:"Outfit", sans-serif; font-weight:700; padding:8px 14px; border-radius:10px; border:1px solid var(--line); background:var(--helpbg); color:var(--ink); cursor:pointer; transition:transform .1s }
.btn:hover{ transform:translateY(-1px) }

/* Tips dialog bonito */
.tips-dialog{ border:none; padding:0; background:transparent }
.tips-card{ width:min(520px,92vw); background:var(--card); border:1px solid var(--line); border-radius:16px; padding:16px }
.tips-list{ margin:0; padding-left:18px }

/* Ayuda (reveal vertical) */
.reveal{ opacity:0; transform:translateY(12px); transition:opacity .5s ease, transform .5s ease; margin-bottom:28px }
.reveal.visible{ opacity:1; transform:none }
.help .help-card{
  background:var(--helpbg); border:1px solid var(--line); border-radius:16px; padding:16px; color:var(--ink);
  word-wrap:break-word; overflow-wrap:break-word; min-height:132px; display:flex; flex-direction:column; gap:8px;
}
.help .help-card h4{ margin:0; line-height:1.2 }
.help .help-card p{ margin:0; color:var(--muted) }
.help .call{
  display:inline-flex; align-items:center; gap:6px; margin-top:auto; padding:8px 10px; border-radius:10px; background:var(--card);
  border:1px solid var(--line); text-decoration:none; color:var(--ink); max-width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}
.help-whats-wrap{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px }
.whats-btn{ display:inline-block; padding:10px 12px; border-radius:10px; border:1px solid var(--line); background:var(--mint); color:#111; text-decoration:none; font-weight:800 }
.help-note{ display:block; margin-top:6px; color:var(--muted) }

/* Blog / Reflexiones (tarjetas atractivas) */
.blog-grid{ display:grid; gap:18px; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)) }
.blog-card{ background:var(--card); border:1px solid var(--line); border-radius:14px; padding:14px; position:relative; overflow:hidden }
.blog-card h4{ margin:0 0 6px }
.blog-card::after{ content:""; position:absolute; right:-18px; bottom:-18px; width:120px; height:120px; border:1px dashed var(--line); transform:rotate(15deg); opacity:.08 }
.blog-card::before{ content:""; position:absolute; left:0; top:0; width:0; height:4px; background:#2E6B54; animation:bookmark 1.4s ease forwards }
@keyframes bookmark{ to{ width:100% } }

/* Sobre (color suave) */
.about-grid{ display:grid; gap:18px; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)) }
.about-card{ background:var(--card); border:1px solid var(--line); border-radius:16px; padding:16px; box-shadow:0 8px 20px rgba(0,0,0,.05) }
.about-card h3{ color:#2E6B54 }

/* Accesibilidad + Discreto */
:focus-visible{ outline:2px solid var(--ring); outline-offset:2px }
html[data-discreet="on"] .brand-sub{ opacity:0 }
html[data-discreet="on"] .title{ visibility:hidden; height:0; margin:0 }
html[data-discreet="on"] .hero .subtle{ opacity:0 }

.site-footer{ margin-top:28px; padding:24px 20px; text-align:center; color:var(--muted) }

@media (max-width:900px){
  .slide iframe{ height:260px }
}
